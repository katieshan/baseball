setwd("C:/Users/Katie/Documents/GitHub/baseball")
source("preprocessing_code/calcpoints.R")
library(tidyverse)
library(mlr)
bats_input <- readRDS("clean_data/retrobats2017.RDS")
names(bats_input)
summarise_at(mode=mode, -person.key)
?summarise_at
bats_mode <- bats_input %>%
select(person.key, team.key, slot) %>%
group_by(person.key)
View(bats_mode)
bats_sum <- bats_input %>%
select(-game.key, -game.date, -team.alignment, -team.key, -opponent.key, -slot, -seq,
team.key.home, -team.key.away, -homescore, -awayscore) %>%
group_by(person.key) %>%
summarise_if(is.numeric, funs(sum=sum), na.rm=TRUE)
View(bats_sum)
bats_mean <- bats_input %>%
select(-game.key, -game.date, -team.alignment, -team.key, -opponent.key, -slot, -seq,
team.key.home, -team.key.away, -homescore, -awayscore, -B_G_DH, -B_G_PH, -B_G_PR, -F_1B_POS,
-F_2B_POS, -F_3B_POS, -F_SS_POS, -F_OF_POS, -F_LF_POS, -F_CF_POS, -F_RF_POS, F_C_POS, -F_P_POS) %>%
group_by(person.key) %>%
summarise_if(is.numeric, list(mean=mean, sd=sd), na.rm=TRUE)
View(bats_mean)
bats_mean <- bats_input %>%
select(-game.key, -game.date, -team.alignment, -team.key, -opponent.key, -slot, -seq,
team.key.home, -team.key.away, -homescore, -awayscore, -B_G_DH, -B_G_PH, -B_G_PR, -F_1B_POS,
-F_2B_POS, -F_3B_POS, -F_SS_POS, -F_OF_POS, -F_LF_POS, -F_CF_POS, -F_RF_POS, F_C_POS, -F_P_POS) %>%
group_by(person.key) %>%
summarise_if(is.numeric, funs(mean=mean), na.rm=TRUE)
summarise_at(c("team.key", "slot"), funs(mode=mode), na.rm=TRUE)
summarise_at(c("team.key", "slot"), funs(mode=mode))
summarise_at(c("team.key", "slot"), mode=mode)
summarise_at(c("team.key", "slot"), mode)
summarise_at(c("team.key", "slot"), mode=mode)
summarise_at(.vars=c("team.key", "slot"), mode=mode)
bats_mean <- bats_input %>%
select(-game.key, -game.date, -team.alignment, -team.key, -opponent.key, -slot, -seq,
team.key.home, -team.key.away, -homescore, -awayscore, -B_G_DH, -B_G_PH, -B_G_PR, -F_1B_POS,
-F_2B_POS, -F_3B_POS, -F_SS_POS, -F_OF_POS, -F_LF_POS, -F_CF_POS, -F_RF_POS, F_C_POS, -F_P_POS) %>%
group_by(person.key) %>%
summarise_if(is.numeric, funs(mean=mean), na.rm=TRUE)
bats_sd <- bats_input %>%
select(-game.key, -game.date, -team.alignment, -team.key, -opponent.key, -slot, -seq,
team.key.home, -team.key.away, -homescore, -awayscore, -B_G_DH, -B_G_PH, -B_G_PR, -F_1B_POS,
-F_2B_POS, -F_3B_POS, -F_SS_POS, -F_OF_POS, -F_LF_POS, -F_CF_POS, -F_RF_POS, F_C_POS, -F_P_POS) %>%
group_by(person.key) %>%
summarise_if(is.numeric, funs(sd=sd), na.rm=TRUE)
summarise_at(.vars=c("team.key", "slot"), mode=mode())
summarise_at(c("team.key", "slot"), mode=mode())
summarise_all(mode=mode())
bats_mode <- bats_input %>%
select(person.key, team.key, slot) %>%
group_by(person.key) %>%
summarise(c("team.key", "slot"), mode=mode())
bats_mode <- bats_input %>%
select(person.key, team.key, slot) %>%
group_by(person.key) %>%
summarise_at(c("team.key", "slot"), mode=mode())
bats_mode <- bats_input %>%
select(person.key, team.key, slot) %>%
group_by(person.key) %>%
summarise(mode)
bats_mode <- bats_input %>%
select(person.key, team.key, slot) %>%
group_by(person.key) %>%
summarise(mode=mode)
bats_mode <- bats_input %>%
select(person.key, team.key, slot) %>%
group_by(person.key) %>%
summarise_all(mode=mode)
bats_mode <- bats_input %>%
select(person.key, team.key, slot) %>%
group_by(person.key) %>%
summarise_all(funs(mode=mode))
View(bats_mode)
calcmode <- function(codes){
which.max(tabulate(codes))
}
bats_mode <- bats_input %>%
select(person.key, team.key, slot) %>%
group_by(person.key) %>%
summarise_all(funs(mode=calcmode))
View(bats_mode)
View(bats_input)
bats_mode <- bats_input %>%
select(person.key, team.key, slot) %>%
group_by(person.key) %>%
summarise(mode=calcmode(team.key))
View(bats_mode)
View(bats_input)
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
bats_mode <- bats_input %>%
select(person.key, team.key, slot) %>%
group_by(person.key) %>%
summarise(mode=getmode(team.key))
View(bats_mode)
bats_mode <- bats_input %>%
select(person.key, team.key, slot) %>%
group_by(person.key) %>%
summarise_all(funs(mode=getmode))
View(bats_mode)
bats_all <- join_all(bats_sum, bats_mean, bats_sd, bats_mode, by='person.key', type='full')
library(plyr)
bats_all <- join_all(bats_sum, bats_mean, bats_sd, bats_mode, by='person.key', type='full')
bats_all <- merge(bats_sum, bats_mean, by="person.key")
View(bats_all)
bats_all <- merge(bats_all, bats_sd, by="person.key")
bats_all <- merge(bats_all, bats_mode, by="person.key")
View(bats_input)
View(bats_all)
